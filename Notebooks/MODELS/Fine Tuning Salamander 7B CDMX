{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"machine_shape":"hm","gpuType":"A100","authorship_tag":"ABX9TyP9iMa0bjPriZpLRcRhfuQw"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"ddcb577f40fd4fdb915a31557f0a2059":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ca4246a3e69d44f4b1481cbccc4adf0a","IPY_MODEL_babc5d534f07455dbf26254dfa6c7095","IPY_MODEL_fcc9777fb8d146ca8c0a979396f877e6"],"layout":"IPY_MODEL_644ed48935ef4d9d8ffd85ea0453dd34"}},"ca4246a3e69d44f4b1481cbccc4adf0a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_acd3e50979be43beb90733496ec69110","placeholder":"​","style":"IPY_MODEL_5b00446f8c3e45c59b923bdf3513d8ea","value":"Map: 100%"}},"babc5d534f07455dbf26254dfa6c7095":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6e5ccd059dfa436c8d3281164a74f9e0","max":3938,"min":0,"orientation":"horizontal","style":"IPY_MODEL_63b36658d82f43fcbd33ea0eb5cea69b","value":3938}},"fcc9777fb8d146ca8c0a979396f877e6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bf086138bd0a44da9d6c94f868420469","placeholder":"​","style":"IPY_MODEL_89b4a5bd81e64b1db4cfdbf1076de9d5","value":" 3938/3938 [00:00&lt;00:00, 11730.74 examples/s]"}},"644ed48935ef4d9d8ffd85ea0453dd34":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"acd3e50979be43beb90733496ec69110":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5b00446f8c3e45c59b923bdf3513d8ea":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6e5ccd059dfa436c8d3281164a74f9e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"63b36658d82f43fcbd33ea0eb5cea69b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bf086138bd0a44da9d6c94f868420469":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"89b4a5bd81e64b1db4cfdbf1076de9d5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e0ba386ded5e4c928d2d8110c5e7a559":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2ae8bed200594738ba7d2fbeba9eddd4","IPY_MODEL_50de7e0506e640d0b0f113bc5cd580d2","IPY_MODEL_1e6cfc63a6e64927aa39ee71fd01d1d5"],"layout":"IPY_MODEL_e0fc7f0f63264721a8b9f93e4045e33d"}},"2ae8bed200594738ba7d2fbeba9eddd4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_50f8c67d0b994a20912ecc5eaf113b7d","placeholder":"​","style":"IPY_MODEL_b8b5b2c349464c94add724714bea0bd8","value":"Map: 100%"}},"50de7e0506e640d0b0f113bc5cd580d2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9671452046e94ba5bd03f545ae582b3a","max":438,"min":0,"orientation":"horizontal","style":"IPY_MODEL_41c15466fdfd4bcc94b5c7c76ed73da8","value":438}},"1e6cfc63a6e64927aa39ee71fd01d1d5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f64c813956c24604b09cf1ca862d3397","placeholder":"​","style":"IPY_MODEL_1fc4eac7f17f40e880128e9a802edfd0","value":" 438/438 [00:00&lt;00:00, 9140.01 examples/s]"}},"e0fc7f0f63264721a8b9f93e4045e33d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"50f8c67d0b994a20912ecc5eaf113b7d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b8b5b2c349464c94add724714bea0bd8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9671452046e94ba5bd03f545ae582b3a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"41c15466fdfd4bcc94b5c7c76ed73da8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f64c813956c24604b09cf1ca862d3397":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1fc4eac7f17f40e880128e9a802edfd0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"69067d88398a405f8af203062e1867e9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_7a9ff88fd76e425e9c122fd008f42f3e","IPY_MODEL_cc1db1eec00c44ddb2c837c1e7b4c8ba","IPY_MODEL_22aefa35528b4999a1156ce301cd277f"],"layout":"IPY_MODEL_c78e080686144a9090b6881709dd7dd3"}},"7a9ff88fd76e425e9c122fd008f42f3e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_018b3db0d39a4a8aa18e71205e4685e9","placeholder":"​","style":"IPY_MODEL_31d736e7bab84a5791ca27b8e3f0601f","value":"Loading checkpoint shards: 100%"}},"cc1db1eec00c44ddb2c837c1e7b4c8ba":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_5903c5e2810142c1ad4584c60428e770","max":4,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6d739620b61c46e7833d564463db0431","value":4}},"22aefa35528b4999a1156ce301cd277f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4f85ac6440a24ef492732f3b6ee99a58","placeholder":"​","style":"IPY_MODEL_07baa486ec42472eab205d486700e3d5","value":" 4/4 [00:15&lt;00:00,  3.24s/it]"}},"c78e080686144a9090b6881709dd7dd3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"018b3db0d39a4a8aa18e71205e4685e9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"31d736e7bab84a5791ca27b8e3f0601f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5903c5e2810142c1ad4584c60428e770":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6d739620b61c46e7833d564463db0431":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4f85ac6440a24ef492732f3b6ee99a58":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"07baa486ec42472eab205d486700e3d5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0220426c05f9495c8646d586c7594708":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_831c584b17a44f17b33f46f1e6442b9f","IPY_MODEL_5d10cc1cd24c409b8caf949e8a6db15d","IPY_MODEL_b4c8c0a7f1fe4b0dae364236a1c0c7d5"],"layout":"IPY_MODEL_e4101b6a8105465bbf816f2b83a19217"}},"831c584b17a44f17b33f46f1e6442b9f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_79687bbae5184b5e84dbc2b0cf5ce416","placeholder":"​","style":"IPY_MODEL_dac9cbb918214625ad2125aa51450315","value":"Map: 100%"}},"5d10cc1cd24c409b8caf949e8a6db15d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_3240ef5f5c094bda94c980e46708aedb","max":3938,"min":0,"orientation":"horizontal","style":"IPY_MODEL_09a7fbf5e99a41529aff3de57d7e884b","value":3938}},"b4c8c0a7f1fe4b0dae364236a1c0c7d5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0121b0808c9943d2a9fcfa6322440894","placeholder":"​","style":"IPY_MODEL_fdba018f063a4218bd37f554419d7254","value":" 3938/3938 [00:00&lt;00:00, 4316.80 examples/s]"}},"e4101b6a8105465bbf816f2b83a19217":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"79687bbae5184b5e84dbc2b0cf5ce416":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dac9cbb918214625ad2125aa51450315":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3240ef5f5c094bda94c980e46708aedb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"09a7fbf5e99a41529aff3de57d7e884b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0121b0808c9943d2a9fcfa6322440894":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fdba018f063a4218bd37f554419d7254":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cdb2d1e8e36c4c5cb4e68abcd8bc3dfa":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_db682b87daad4645a6ba2935d5247a75","IPY_MODEL_c246a73d9780497fb0b91bf899d8d198","IPY_MODEL_e4f9166f7e0c447085ccfb104340e606"],"layout":"IPY_MODEL_ce5278e550b7479eae74ae7eaf17a517"}},"db682b87daad4645a6ba2935d5247a75":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2a9c393930244f24812012e420c0ed65","placeholder":"​","style":"IPY_MODEL_555637a5677e4441ad6ba7ce88467591","value":"Map: 100%"}},"c246a73d9780497fb0b91bf899d8d198":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_34173d5885334ce484ad896c44427f9d","max":438,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9a30c5f89e3c4b89bbf7c8bbc0bbea42","value":438}},"e4f9166f7e0c447085ccfb104340e606":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6723bb958fab4fd998e0191cb52afdf0","placeholder":"​","style":"IPY_MODEL_86b112167ba84cc9a3b376d0353c6778","value":" 438/438 [00:00&lt;00:00, 4337.18 examples/s]"}},"ce5278e550b7479eae74ae7eaf17a517":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2a9c393930244f24812012e420c0ed65":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"555637a5677e4441ad6ba7ce88467591":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"34173d5885334ce484ad896c44427f9d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9a30c5f89e3c4b89bbf7c8bbc0bbea42":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6723bb958fab4fd998e0191cb52afdf0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"86b112167ba84cc9a3b376d0353c6778":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8xkltiIsNNxm","executionInfo":{"status":"ok","timestamp":1750119662510,"user_tz":-60,"elapsed":22339,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}},"outputId":"779997e7-9ff1-4444-ff0c-c17f083a7122"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting git+https://github.com/huggingface/transformers.git\n","  Cloning https://github.com/huggingface/transformers.git to /tmp/pip-req-build-gnx8nft6\n","  Running command git clone --filter=blob:none --quiet https://github.com/huggingface/transformers.git /tmp/pip-req-build-gnx8nft6\n","  Resolved https://github.com/huggingface/transformers.git to commit e61160c5dbd470c4644e6c248d2acb64f763b6d5\n","  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (3.18.0)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.30.0 in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (0.33.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (1.26.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (24.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (6.0.2)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (2024.11.6)\n","Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (2.32.3)\n","Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (0.21.1)\n","Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (0.5.3)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.11/dist-packages (from transformers==4.53.0.dev0) (4.67.1)\n","Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0,>=0.30.0->transformers==4.53.0.dev0) (2025.3.2)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0,>=0.30.0->transformers==4.53.0.dev0) (4.14.0)\n","Requirement already satisfied: hf-xet<2.0.0,>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0,>=0.30.0->transformers==4.53.0.dev0) (1.1.3)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests->transformers==4.53.0.dev0) (3.4.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests->transformers==4.53.0.dev0) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests->transformers==4.53.0.dev0) (2.4.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests->transformers==4.53.0.dev0) (2025.4.26)\n"]}],"source":["!pip install git+https://github.com/huggingface/transformers.git\n","!pip install -q peft accelerate datasets bitsandbytes trl protobuf==3.20.3"]},{"cell_type":"code","source":["from transformers import AutoTokenizer, AutoModelForCausalLM, TrainingArguments, Trainer\n","from peft import LoraConfig, get_peft_model, prepare_model_for_kbit_training\n","from datasets import load_dataset, Dataset\n","from transformers import DataCollatorForLanguageModeling\n","import torch\n","import json"],"metadata":{"id":"SrV_VBZcN3Aa","executionInfo":{"status":"ok","timestamp":1750119676724,"user_tz":-60,"elapsed":9569,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":["# Cargar desde archivo local\n","with open(\"/content/dataset_CDMX_C-D+_18-25.jsonl\", \"r\", encoding=\"utf-8\") as f:\n","    data = [json.loads(line) for line in f]\n","\n","# Convertir a dataset HuggingFace\n","dataset = Dataset.from_list(data)\n","dataset = dataset.train_test_split(test_size=0.1)\n"],"metadata":{"id":"Qsuyj9O1OSZk","executionInfo":{"status":"ok","timestamp":1750119687875,"user_tz":-60,"elapsed":22,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}}},"execution_count":3,"outputs":[]},{"cell_type":"markdown","source":["Salamander 7B"],"metadata":{"id":"88YLcTHDOfVL"}},{"cell_type":"code","source":["def format_instruction(example):\n","    return {\n","        \"text\": f\"\"\"### Instrucción:\n","{example['instruction']}\n","\n","### Respuesta:\n","{example['response']}\"\"\"\n","    }\n","\n","dataset = dataset.map(format_instruction)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["ddcb577f40fd4fdb915a31557f0a2059","ca4246a3e69d44f4b1481cbccc4adf0a","babc5d534f07455dbf26254dfa6c7095","fcc9777fb8d146ca8c0a979396f877e6","644ed48935ef4d9d8ffd85ea0453dd34","acd3e50979be43beb90733496ec69110","5b00446f8c3e45c59b923bdf3513d8ea","6e5ccd059dfa436c8d3281164a74f9e0","63b36658d82f43fcbd33ea0eb5cea69b","bf086138bd0a44da9d6c94f868420469","89b4a5bd81e64b1db4cfdbf1076de9d5","e0ba386ded5e4c928d2d8110c5e7a559","2ae8bed200594738ba7d2fbeba9eddd4","50de7e0506e640d0b0f113bc5cd580d2","1e6cfc63a6e64927aa39ee71fd01d1d5","e0fc7f0f63264721a8b9f93e4045e33d","50f8c67d0b994a20912ecc5eaf113b7d","b8b5b2c349464c94add724714bea0bd8","9671452046e94ba5bd03f545ae582b3a","41c15466fdfd4bcc94b5c7c76ed73da8","f64c813956c24604b09cf1ca862d3397","1fc4eac7f17f40e880128e9a802edfd0"]},"id":"-osdW8weOdb3","executionInfo":{"status":"ok","timestamp":1750119698866,"user_tz":-60,"elapsed":397,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}},"outputId":"c55accf8-94a3-4329-dbef-c53a15d763c2"},"execution_count":4,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/3938 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ddcb577f40fd4fdb915a31557f0a2059"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/438 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e0ba386ded5e4c928d2d8110c5e7a559"}},"metadata":{}}]},{"cell_type":"code","source":["model_name = \"BSC-LT/salamandra-7b-instruct\"\n","\n","tokenizer = AutoTokenizer.from_pretrained(model_name, use_fast=True)\n","base_model = AutoModelForCausalLM.from_pretrained(\n","    model_name,\n","    load_in_4bit=True,\n","    device_map=\"auto\"\n",")\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":191,"referenced_widgets":["69067d88398a405f8af203062e1867e9","7a9ff88fd76e425e9c122fd008f42f3e","cc1db1eec00c44ddb2c837c1e7b4c8ba","22aefa35528b4999a1156ce301cd277f","c78e080686144a9090b6881709dd7dd3","018b3db0d39a4a8aa18e71205e4685e9","31d736e7bab84a5791ca27b8e3f0601f","5903c5e2810142c1ad4584c60428e770","6d739620b61c46e7833d564463db0431","4f85ac6440a24ef492732f3b6ee99a58","07baa486ec42472eab205d486700e3d5"]},"id":"-lYfs48NPOVV","executionInfo":{"status":"ok","timestamp":1750119730102,"user_tz":-60,"elapsed":24725,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}},"outputId":"ee913ff0-efe6-4763-8fdc-8c13fabb33a4"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: \n","The secret `HF_TOKEN` does not exist in your Colab secrets.\n","To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.\n","You will be able to reuse this secret in all of your notebooks.\n","Please note that authentication is recommended but still optional to access public models or datasets.\n","  warnings.warn(\n","The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.\n"]},{"output_type":"display_data","data":{"text/plain":["Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"69067d88398a405f8af203062e1867e9"}},"metadata":{}}]},{"cell_type":"code","source":["model = prepare_model_for_kbit_training(base_model)\n","\n","lora_config = LoraConfig(\n","    r=8,\n","    lora_alpha=16,\n","    target_modules=[\"q_proj\", \"v_proj\"],\n","    lora_dropout=0.05,\n","    bias=\"none\",\n","    task_type=\"CAUSAL_LM\"\n",")\n","\n","model = get_peft_model(model, lora_config)\n"],"metadata":{"id":"-S_5MRWXPVx6","executionInfo":{"status":"ok","timestamp":1750119739170,"user_tz":-60,"elapsed":127,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["def tokenize(example):\n","    return tokenizer(example[\"text\"], truncation=True, padding=\"max_length\", max_length=512)\n","\n","tokenized_dataset = dataset.map(tokenize, batched=True)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["0220426c05f9495c8646d586c7594708","831c584b17a44f17b33f46f1e6442b9f","5d10cc1cd24c409b8caf949e8a6db15d","b4c8c0a7f1fe4b0dae364236a1c0c7d5","e4101b6a8105465bbf816f2b83a19217","79687bbae5184b5e84dbc2b0cf5ce416","dac9cbb918214625ad2125aa51450315","3240ef5f5c094bda94c980e46708aedb","09a7fbf5e99a41529aff3de57d7e884b","0121b0808c9943d2a9fcfa6322440894","fdba018f063a4218bd37f554419d7254","cdb2d1e8e36c4c5cb4e68abcd8bc3dfa","db682b87daad4645a6ba2935d5247a75","c246a73d9780497fb0b91bf899d8d198","e4f9166f7e0c447085ccfb104340e606","ce5278e550b7479eae74ae7eaf17a517","2a9c393930244f24812012e420c0ed65","555637a5677e4441ad6ba7ce88467591","34173d5885334ce484ad896c44427f9d","9a30c5f89e3c4b89bbf7c8bbc0bbea42","6723bb958fab4fd998e0191cb52afdf0","86b112167ba84cc9a3b376d0353c6778"]},"id":"A7Z2yS68PwNB","executionInfo":{"status":"ok","timestamp":1750119748890,"user_tz":-60,"elapsed":1588,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}},"outputId":"4d9669fa-6d8a-49db-95ce-7ad30a4ceae6"},"execution_count":7,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/3938 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0220426c05f9495c8646d586c7594708"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/438 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"cdb2d1e8e36c4c5cb4e68abcd8bc3dfa"}},"metadata":{}}]},{"cell_type":"code","source":["training_args = TrainingArguments(\n","    output_dir=\"./outputs\",\n","    per_device_train_batch_size=4,\n","    per_device_eval_batch_size=4,\n","    logging_steps=50,\n","    num_train_epochs=3,\n","    save_strategy=\"epoch\",\n","    learning_rate=2e-4,\n","    bf16=False,\n","    fp16=True,\n","    optim=\"paged_adamw_8bit\",\n","    report_to=\"none\"\n",")\n","\n","trainer = Trainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=tokenized_dataset[\"train\"],\n","    eval_dataset=tokenized_dataset[\"test\"],\n","    tokenizer=tokenizer,\n","    data_collator=DataCollatorForLanguageModeling(tokenizer, mlm=False)\n",")\n","\n","trainer.train()\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"LC1e2QBPP4Gk","executionInfo":{"status":"ok","timestamp":1750122347069,"user_tz":-60,"elapsed":2590613,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}},"outputId":"5d59b61a-7b37-4563-d5ae-8c4a176e5fcc"},"execution_count":8,"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-8-1081526640>:15: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.\n","  trainer = Trainer(\n","No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.\n","`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/bitsandbytes/nn/modules.py:463: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.\n","  warnings.warn(\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='2955' max='2955' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [2955/2955 43:08, Epoch 3/3]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>50</td>\n","      <td>1.876400</td>\n","    </tr>\n","    <tr>\n","      <td>100</td>\n","      <td>1.538800</td>\n","    </tr>\n","    <tr>\n","      <td>150</td>\n","      <td>1.626500</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>1.596100</td>\n","    </tr>\n","    <tr>\n","      <td>250</td>\n","      <td>1.476200</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>1.459000</td>\n","    </tr>\n","    <tr>\n","      <td>350</td>\n","      <td>1.414900</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>1.416200</td>\n","    </tr>\n","    <tr>\n","      <td>450</td>\n","      <td>1.423600</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>1.439700</td>\n","    </tr>\n","    <tr>\n","      <td>550</td>\n","      <td>1.465600</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>1.477200</td>\n","    </tr>\n","    <tr>\n","      <td>650</td>\n","      <td>1.465400</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>1.431500</td>\n","    </tr>\n","    <tr>\n","      <td>750</td>\n","      <td>1.435100</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>1.496900</td>\n","    </tr>\n","    <tr>\n","      <td>850</td>\n","      <td>1.307200</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>1.406600</td>\n","    </tr>\n","    <tr>\n","      <td>950</td>\n","      <td>1.363800</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>1.477700</td>\n","    </tr>\n","    <tr>\n","      <td>1050</td>\n","      <td>1.297100</td>\n","    </tr>\n","    <tr>\n","      <td>1100</td>\n","      <td>1.269200</td>\n","    </tr>\n","    <tr>\n","      <td>1150</td>\n","      <td>1.380800</td>\n","    </tr>\n","    <tr>\n","      <td>1200</td>\n","      <td>1.373100</td>\n","    </tr>\n","    <tr>\n","      <td>1250</td>\n","      <td>1.377100</td>\n","    </tr>\n","    <tr>\n","      <td>1300</td>\n","      <td>1.428700</td>\n","    </tr>\n","    <tr>\n","      <td>1350</td>\n","      <td>1.362900</td>\n","    </tr>\n","    <tr>\n","      <td>1400</td>\n","      <td>1.387300</td>\n","    </tr>\n","    <tr>\n","      <td>1450</td>\n","      <td>1.395000</td>\n","    </tr>\n","    <tr>\n","      <td>1500</td>\n","      <td>1.351800</td>\n","    </tr>\n","    <tr>\n","      <td>1550</td>\n","      <td>1.385200</td>\n","    </tr>\n","    <tr>\n","      <td>1600</td>\n","      <td>1.409000</td>\n","    </tr>\n","    <tr>\n","      <td>1650</td>\n","      <td>1.319500</td>\n","    </tr>\n","    <tr>\n","      <td>1700</td>\n","      <td>1.318500</td>\n","    </tr>\n","    <tr>\n","      <td>1750</td>\n","      <td>1.388000</td>\n","    </tr>\n","    <tr>\n","      <td>1800</td>\n","      <td>1.349800</td>\n","    </tr>\n","    <tr>\n","      <td>1850</td>\n","      <td>1.329900</td>\n","    </tr>\n","    <tr>\n","      <td>1900</td>\n","      <td>1.317500</td>\n","    </tr>\n","    <tr>\n","      <td>1950</td>\n","      <td>1.260200</td>\n","    </tr>\n","    <tr>\n","      <td>2000</td>\n","      <td>1.270600</td>\n","    </tr>\n","    <tr>\n","      <td>2050</td>\n","      <td>1.323400</td>\n","    </tr>\n","    <tr>\n","      <td>2100</td>\n","      <td>1.367800</td>\n","    </tr>\n","    <tr>\n","      <td>2150</td>\n","      <td>1.296800</td>\n","    </tr>\n","    <tr>\n","      <td>2200</td>\n","      <td>1.269000</td>\n","    </tr>\n","    <tr>\n","      <td>2250</td>\n","      <td>1.410500</td>\n","    </tr>\n","    <tr>\n","      <td>2300</td>\n","      <td>1.342200</td>\n","    </tr>\n","    <tr>\n","      <td>2350</td>\n","      <td>1.283100</td>\n","    </tr>\n","    <tr>\n","      <td>2400</td>\n","      <td>1.209100</td>\n","    </tr>\n","    <tr>\n","      <td>2450</td>\n","      <td>1.227200</td>\n","    </tr>\n","    <tr>\n","      <td>2500</td>\n","      <td>1.274300</td>\n","    </tr>\n","    <tr>\n","      <td>2550</td>\n","      <td>1.349500</td>\n","    </tr>\n","    <tr>\n","      <td>2600</td>\n","      <td>1.365900</td>\n","    </tr>\n","    <tr>\n","      <td>2650</td>\n","      <td>1.210400</td>\n","    </tr>\n","    <tr>\n","      <td>2700</td>\n","      <td>1.258300</td>\n","    </tr>\n","    <tr>\n","      <td>2750</td>\n","      <td>1.282500</td>\n","    </tr>\n","    <tr>\n","      <td>2800</td>\n","      <td>1.293400</td>\n","    </tr>\n","    <tr>\n","      <td>2850</td>\n","      <td>1.347500</td>\n","    </tr>\n","    <tr>\n","      <td>2900</td>\n","      <td>1.339800</td>\n","    </tr>\n","    <tr>\n","      <td>2950</td>\n","      <td>1.291400</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n","/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n","  return fn(*args, **kwargs)\n"]},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=2955, training_loss=1.3780249203522192, metrics={'train_runtime': 2590.1445, 'train_samples_per_second': 4.561, 'train_steps_per_second': 1.141, 'total_flos': 2.4399335701610496e+17, 'train_loss': 1.3780249203522192, 'epoch': 3.0})"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["model.save_pretrained(\"/content/salamandra_cdmx_model\")\n","tokenizer.save_pretrained(\"/content/salamandra_cdmx_model\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xu7niE9XbP1T","executionInfo":{"status":"ok","timestamp":1750122433565,"user_tz":-60,"elapsed":849,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}},"outputId":"e4c24521-a150-4258-b27b-a289df8688e6"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('/content/salamandra_cdmx_model/tokenizer_config.json',\n"," '/content/salamandra_cdmx_model/special_tokens_map.json',\n"," '/content/salamandra_cdmx_model/chat_template.jinja',\n"," '/content/salamandra_cdmx_model/tokenizer.model',\n"," '/content/salamandra_cdmx_model/added_tokens.json',\n"," '/content/salamandra_cdmx_model/tokenizer.json')"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["!zip -r salamandra_cdmx_model.zip /content/salamandra_cdmx_model\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"asvhT4acbZ7Y","executionInfo":{"status":"ok","timestamp":1750122474756,"user_tz":-60,"elapsed":2310,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}},"outputId":"bcb4aa8d-1109-42af-9185-e4c3474f6b3b"},"execution_count":10,"outputs":[{"output_type":"stream","name":"stdout","text":["  adding: content/salamandra_cdmx_model/ (stored 0%)\n","  adding: content/salamandra_cdmx_model/special_tokens_map.json (deflated 76%)\n","  adding: content/salamandra_cdmx_model/tokenizer.model (deflated 53%)\n","  adding: content/salamandra_cdmx_model/adapter_config.json (deflated 54%)\n","  adding: content/salamandra_cdmx_model/adapter_model.safetensors (deflated 7%)\n","  adding: content/salamandra_cdmx_model/chat_template.jinja (deflated 53%)\n","  adding: content/salamandra_cdmx_model/README.md (deflated 66%)\n","  adding: content/salamandra_cdmx_model/tokenizer_config.json (deflated 95%)\n","  adding: content/salamandra_cdmx_model/tokenizer.json (deflated 84%)\n"]}]},{"cell_type":"code","source":["from google.colab import files\n","files.download(\"/content/salamandra_cdmx_model.zip\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":17},"id":"I45OVTecbcFi","executionInfo":{"status":"ok","timestamp":1750122483654,"user_tz":-60,"elapsed":16,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}},"outputId":"77159556-0e5b-4f5a-a685-1bb7feb7d8e1"},"execution_count":11,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_476e48ce-f3a3-4406-b3a9-35d536444558\", \"salamandra_cdmx_model.zip\", 20718984)"]},"metadata":{}}]},{"cell_type":"code","source":["model.save_pretrained(\"/content/salamandra_cdmx_model\")\n","tokenizer.save_pretrained(\"/content/salamandra_cdmx_model\")\n"],"metadata":{"id":"joTrd4u3eEOF","executionInfo":{"status":"ok","timestamp":1750123172171,"user_tz":-60,"elapsed":939,"user":{"displayName":"Joaquin Garcia Luna Perez","userId":"01168812787878955692"}},"outputId":"d0264290-7881-4649-8fb3-9f6b76898730","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":12,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('/content/salamandra_cdmx_model/tokenizer_config.json',\n"," '/content/salamandra_cdmx_model/special_tokens_map.json',\n"," '/content/salamandra_cdmx_model/chat_template.jinja',\n"," '/content/salamandra_cdmx_model/tokenizer.model',\n"," '/content/salamandra_cdmx_model/added_tokens.json',\n"," '/content/salamandra_cdmx_model/tokenizer.json')"]},"metadata":{},"execution_count":12}]}]}